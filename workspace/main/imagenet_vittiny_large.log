(arpgen) wangkai@5a21df081e09:~/arpgen/AR-Param-Generation/workspace/main$ sh imagenet_vittiny_large.sh
The following values were not passed to `accelerate launch` and had defaults used instead:
                More than one GPU was found, enabling multi-GPU training.
                If this was unintended please pass in `--num_processes=1`.
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
==> Preparing data..
checkpoint number: 51
input shape: torch.Size([808, 8192])
useful ratio: tensor(0.8638)
sequence length: 808
==> Building model..
==> Building optimizer..
wandb: Currently logged in as: mtdoven. Use `wandb login --relogin` to force relogin
wandb: WARNING If you're specifying your api key in code, ensure this code is not shared publicly.
wandb: WARNING Consider setting the WANDB_API_KEY environment variable, or running `wandb login` from the command line.
wandb: Appending key for api.wandb.ai to your netrc file: /home/wangkai/.netrc
wandb: wandb version 0.17.8 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.4
wandb: Run data is saved locally in /home/wangkai/arpgen/AR-Param-Generation/wandb/run-20240901_062241-qkf1qhtg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run imagenet_vittiny_large
wandb: __ View project at https://wandb.ai/mtdoven/ARPGEN
wandb: __ View run at https://wandb.ai/mtdoven/ARPGEN/runs/qkf1qhtg
==> Defining training..
==> start training..

==> Generating..
Generated_norm: 175.67132568359375
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:22<00:00, 10.90it/s]
Loss: 100478.8411 | Acc: 0.0010



==> Generating..
Generated_norm: 0.7437430024147034
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.59it/s]
Loss: 8.5285 | Acc: 0.0009



==> Generating..
Generated_norm: 0.766956090927124
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.05it/s]
Loss: 4.3407 | Acc: 0.2123



==> Generating..
Generated_norm: 0.7693962454795837
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.36it/s]
Loss: 2.7776 | Acc: 0.4028



==> Generating..
Generated_norm: 0.7706925868988037
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:22<00:00, 11.09it/s]
Loss: 1.7981 | Acc: 0.5728



==> Generating..
Generated_norm: 0.771234393119812
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.61it/s]
Loss: 1.9750 | Acc: 0.5389



==> Generating..
Generated_norm: 0.767153263092041
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.18it/s]
Loss: 1.7185 | Acc: 0.5906



==> Generating..
Generated_norm: 0.777781069278717
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.62it/s]
Loss: 1.5644 | Acc: 0.6164



==> Generating..
Generated_norm: 0.7677624821662903
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.28it/s]
Loss: 1.3634 | Acc: 0.6593



==> Generating..
Generated_norm: 0.7747064232826233
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.40it/s]
Loss: 1.3086 | Acc: 0.6704



==> Generating..
Generated_norm: 0.7747853398323059
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.75it/s]
Loss: 1.3518 | Acc: 0.6612



==> Generating..
Generated_norm: 0.7758673429489136
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.04it/s]
Loss: 1.3821 | Acc: 0.6524



==> Generating..
Generated_norm: 0.7696288824081421
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.72it/s]
Loss: 1.2107 | Acc: 0.6929



==> Generating..
Generated_norm: 0.7772312760353088
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.37it/s]
Loss: 1.4938 | Acc: 0.6355



==> Generating..
Generated_norm: 0.768303632736206
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.81it/s]
Loss: 1.3625 | Acc: 0.6603



==> Generating..
Generated_norm: 0.7762214541435242
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.45it/s]
Loss: 1.1841 | Acc: 0.6995



==> Generating..
Generated_norm: 0.772258460521698
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.54it/s]
Loss: 1.3375 | Acc: 0.6677



==> Generating..
Generated_norm: 0.7764506936073303
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.74it/s]
Loss: 1.1625 | Acc: 0.7039



==> Generating..
Generated_norm: 0.7711867690086365
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:22<00:00, 11.07it/s]
Loss: 1.2138 | Acc: 0.6927



==> Generating..
Generated_norm: 0.7764583826065063
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.75it/s]
Loss: 1.1241 | Acc: 0.7125



==> Generating..
Generated_norm: 0.7762216329574585
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.37it/s]
Loss: 1.1329 | Acc: 0.7106



==> Generating..
Generated_norm: 0.76699298620224
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.33it/s]
Loss: 1.0550 | Acc: 0.7273



==> Generating..
Generated_norm: 0.7676361203193665
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.55it/s]
Loss: 1.0870 | Acc: 0.7201



==> Generating..
Generated_norm: 0.7707217931747437
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.61it/s]
Loss: 1.1332 | Acc: 0.7083



==> Generating..
Generated_norm: 0.7688102722167969
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.62it/s]
Loss: 1.0666 | Acc: 0.7231



==> Generating..
Generated_norm: 0.7699502110481262
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:22<00:00, 10.90it/s]
Loss: 1.0277 | Acc: 0.7321



==> Generating..
Generated_norm: 0.7703371644020081
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.62it/s]
Loss: 1.1413 | Acc: 0.7099



==> Generating..
Generated_norm: 0.7687699198722839
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.46it/s]
Loss: 1.0911 | Acc: 0.7198



==> Generating..
Generated_norm: 0.770263671875
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:22<00:00, 10.97it/s]
Loss: 1.0150 | Acc: 0.7364



==> Generating..
Generated_norm: 0.770141065120697
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.43it/s]
Loss: 1.0598 | Acc: 0.7259



==> Generating..
Generated_norm: 0.7718377709388733
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.69it/s]
Loss: 1.0012 | Acc: 0.7374



==> Generating..
Generated_norm: 0.7703639268875122
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.75it/s]
Loss: 0.9870 | Acc: 0.7421



==> Generating..
Generated_norm: 0.7724182605743408
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.95it/s]
Loss: 0.9916 | Acc: 0.7409



==> Generating..
Generated_norm: 0.7714598774909973
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.37it/s]
Loss: 0.9983 | Acc: 0.7405



==> Generating..
Generated_norm: 0.7722579836845398
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.17it/s]
Loss: 0.9807 | Acc: 0.7452



==> Generating..
Generated_norm: 0.7725616693496704
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.23it/s]
Loss: 0.9712 | Acc: 0.7464



==> Generating..
Generated_norm: 0.7685359120368958
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.26it/s]
Loss: 0.9751 | Acc: 0.7459



==> Generating..
Generated_norm: 0.7718803286552429
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:22<00:00, 11.14it/s]
Loss: 0.9683 | Acc: 0.7461



==> Generating..
Generated_norm: 0.773054838180542
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.75it/s]
Loss: 0.9640 | Acc: 0.7470



==> Generating..
Generated_norm: 0.7655119299888611
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.60it/s]
Loss: 0.9681 | Acc: 0.7470



==> Generating..
Generated_norm: 0.7638401389122009
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.91it/s]
Loss: 0.9693 | Acc: 0.7477



==> Generating..
Generated_norm: 0.7676553726196289
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.55it/s]
Loss: 0.9543 | Acc: 0.7487



==> Generating..
Generated_norm: 0.769938051700592
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.51it/s]
Loss: 0.9527 | Acc: 0.7495



==> Generating..
Generated_norm: 0.7703897953033447
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.79it/s]
Loss: 0.9514 | Acc: 0.7513



==> Generating..
Generated_norm: 0.7650707364082336
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.13it/s]
Loss: 0.9539 | Acc: 0.7503



==> Generating..
Generated_norm: 0.7748318314552307
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.23it/s]
Loss: 0.9524 | Acc: 0.7497



==> Generating..
Generated_norm: 0.7677270770072937
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.33it/s]
Loss: 0.9509 | Acc: 0.7504



==> Generating..
Generated_norm: 0.7682034373283386
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.17it/s]
Loss: 0.9469 | Acc: 0.7529



==> Generating..
Generated_norm: 0.7755129933357239
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.06it/s]
Loss: 0.9499 | Acc: 0.7513



==> Generating..
Generated_norm: 0.7680070996284485
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.97it/s]
Loss: 0.9540 | Acc: 0.7501



==> Generating..
Generated_norm: 0.7660543918609619
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.17it/s]
Loss: 0.9471 | Acc: 0.7509


Finished Training!
wandb: - 0.048 MB of 0.048 MB uploaded (0.003 MB deduped)
wandb: Run history:
wandb: generated_norm ________________________________________
wandb:     train_loss ________________________________________
wandb:
wandb: Run summary:
wandb: generated_norm 0.76605
wandb:     train_loss 0.0124
wandb:
wandb: __ View run imagenet_vittiny_large at: https://wandb.ai/mtdoven/ARPGEN/runs/qkf1qhtg
wandb: __ View project at: https://wandb.ai/mtdoven/ARPGEN
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240901_062241-qkf1qhtg/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.






(arpgen) wangkai@5a21df081e09:~/arpgen/AR-Param-Generation/workspace/evaluate$ CUDA_VISIBLE_DEVICES=7 python generate.py
==> Preparing data..
checkpoint number: 51
input shape: torch.Size([808, 8192])
useful ratio: tensor(0.8638)
sequence length: 808
==> Building model..
==> Building optimizer..
==> Defining training..
==> Building model..
==> Defining generate..
Save to ./dataset/imagenet_vittiny/generated/generated_imagenet_vittiny_large_001.pth

==> Generating..
Generated_norm: 1.1897610425949097
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.68it/s]
Loss: 0.9537 | Acc: 0.7496


Save to ./dataset/imagenet_vittiny/generated/generated_imagenet_vittiny_large_002.pth

==> Generating..
Generated_norm: 1.178430199623108
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.20it/s]
Loss: 0.9500 | Acc: 0.7512


Save to ./dataset/imagenet_vittiny/generated/generated_imagenet_vittiny_large_003.pth

==> Generating..
Generated_norm: 1.1793391704559326
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.00it/s]
Loss: 0.9505 | Acc: 0.7507


Save to ./dataset/imagenet_vittiny/generated/generated_imagenet_vittiny_large_004.pth

==> Generating..
Generated_norm: 1.1886035203933716
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.03it/s]
Loss: 0.9524 | Acc: 0.7511


Save to ./dataset/imagenet_vittiny/generated/generated_imagenet_vittiny_large_005.pth

==> Generating..
Generated_norm: 1.1885544061660767
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.30it/s]
Loss: 0.9521 | Acc: 0.7507


Save to ./dataset/imagenet_vittiny/generated/generated_imagenet_vittiny_large_006.pth

==> Generating..
Generated_norm: 1.1840933561325073
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.91it/s]
Loss: 0.9474 | Acc: 0.7523


Save to ./dataset/imagenet_vittiny/generated/generated_imagenet_vittiny_large_007.pth

==> Generating..
Generated_norm: 1.186960220336914
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.30it/s]
Loss: 0.9465 | Acc: 0.7507


Save to ./dataset/imagenet_vittiny/generated/generated_imagenet_vittiny_large_008.pth

==> Generating..
Generated_norm: 1.1757237911224365
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.22it/s]
Loss: 0.9499 | Acc: 0.7514


Save to ./dataset/imagenet_vittiny/generated/generated_imagenet_vittiny_large_009.pth

==> Generating..
Generated_norm: 1.181368350982666
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.25it/s]
Loss: 0.9482 | Acc: 0.7515


Save to ./dataset/imagenet_vittiny/generated/generated_imagenet_vittiny_large_010.pth

==> Generating..
Generated_norm: 1.1738554239273071
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.21it/s]
Loss: 0.9548 | Acc: 0.7498