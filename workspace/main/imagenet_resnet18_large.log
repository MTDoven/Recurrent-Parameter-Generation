(arpgen) wangkai@5a21df081e09:~/arpgen/AR-Param-Generation/workspace/main$ sh imagenet_resnet18_large.sh
==> Preparing data..
checkpoint number: 50
input shape: torch.Size([1510, 8192])
useful ratio: tensor(0.9458)
sequence length: 1510
==> Building model..
==> Building optimizer..
==> Defining training..
==> Building model..

==> Generating..
Generated_norm: 0.7364174127578735
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.51it/s]
Loss: 6.0805 | Acc: 0.1135



==> Generating..
Generated_norm: 0.736286461353302
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.36it/s]
Loss: 5.4946 | Acc: 0.1315



==> Generating..
Generated_norm: 0.7388031482696533
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.32it/s]
Loss: 4.7628 | Acc: 0.1950



==> Generating..
Generated_norm: 0.7368504405021667
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.99it/s]
Loss: 4.2827 | Acc: 0.2402



==> Generating..
Generated_norm: 0.7378732562065125
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.69it/s]
Loss: 5.3370 | Acc: 0.1944



==> Generating..
Generated_norm: 0.7373574376106262
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.50it/s]
Loss: 5.5222 | Acc: 0.1221



==> Generating..
Generated_norm: 0.7382069826126099
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.47it/s]
Loss: 5.5035 | Acc: 0.1805



==> Generating..
Generated_norm: 0.7390123009681702
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.50it/s]
Loss: 5.1140 | Acc: 0.2064



==> Generating..
Generated_norm: 0.7351830005645752
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.60it/s]
Loss: 3.0292 | Acc: 0.3911



==> Generating..
Generated_norm: 0.736078679561615
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.57it/s]
Loss: 3.8634 | Acc: 0.3316



==> Generating..
Generated_norm: 0.7352039813995361
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.34it/s]
Loss: 2.4155 | Acc: 0.4921



==> Generating..
Generated_norm: 0.737446665763855
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.49it/s]
Loss: 2.7076 | Acc: 0.4459



==> Generating..
Generated_norm: 0.7363476753234863
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.35it/s]
Loss: 2.2598 | Acc: 0.5216



==> Generating..
Generated_norm: 0.7380375266075134
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.54it/s]
Loss: 3.6613 | Acc: 0.3344



==> Generating..
Generated_norm: 0.7371072173118591
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.01it/s]
Loss: 2.4940 | Acc: 0.4878



==> Generating..
Generated_norm: 0.7365739941596985
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.52it/s]
Loss: 2.9179 | Acc: 0.4203



==> Generating..
Generated_norm: 0.7369181513786316
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.36it/s]
Loss: 2.1082 | Acc: 0.5399



==> Generating..
Generated_norm: 0.7357218861579895
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.48it/s]
Loss: 1.9576 | Acc: 0.5619



==> Generating..
Generated_norm: 0.7362195253372192
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.84it/s]
Loss: 2.3226 | Acc: 0.5006



==> Generating..
Generated_norm: 0.7362911105155945
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.28it/s]
Loss: 1.6980 | Acc: 0.6117



==> Generating..
Generated_norm: 0.7356237173080444
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.67it/s]
Loss: 2.0681 | Acc: 0.5513



==> Generating..
Generated_norm: 0.7371072173118591
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.46it/s]
Loss: 2.0543 | Acc: 0.5571



==> Generating..
Generated_norm: 0.7370738983154297
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.02it/s]
Loss: 1.7521 | Acc: 0.6030



==> Generating..
Generated_norm: 0.7362844944000244
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.09it/s]
Loss: 1.5248 | Acc: 0.6449



==> Generating..
Generated_norm: 0.7361600399017334
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.93it/s]
Loss: 1.6242 | Acc: 0.6287



==> Generating..
Generated_norm: 0.738237202167511
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.22it/s]
Loss: 1.5299 | Acc: 0.6461



==> Generating..
Generated_norm: 0.7366068363189697
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.77it/s]
Loss: 1.6480 | Acc: 0.6287



==> Generating..
Generated_norm: 0.7369800209999084
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.79it/s]
Loss: 1.4237 | Acc: 0.6671



==> Generating..
Generated_norm: 0.7360963821411133
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.77it/s]
Loss: 1.4940 | Acc: 0.6523



==> Generating..
Generated_norm: 0.737741231918335
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.62it/s]
Loss: 1.3582 | Acc: 0.6803



==> Generating..
Generated_norm: 0.7376022338867188
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.05it/s]
Loss: 1.3987 | Acc: 0.6721



==> Generating..
Generated_norm: 0.7376663088798523
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.31it/s]
Loss: 1.3586 | Acc: 0.6825



==> Generating..
Generated_norm: 0.7369853258132935
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.73it/s]
Loss: 1.3407 | Acc: 0.6867



==> Generating..
Generated_norm: 0.7371887564659119
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.00it/s]
Loss: 1.3769 | Acc: 0.6777



==> Generating..
Generated_norm: 0.7373765707015991
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.46it/s]
Loss: 1.3367 | Acc: 0.6835



==> Generating..
Generated_norm: 0.7374203205108643
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.08it/s]
Loss: 1.3217 | Acc: 0.6886



==> Generating..
Generated_norm: 0.7369829416275024
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.91it/s]
Loss: 1.3548 | Acc: 0.6818



==> Generating..
Generated_norm: 0.7368887662887573
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.36it/s]
Loss: 1.2907 | Acc: 0.6921



==> Generating..
Generated_norm: 0.7373712062835693
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.51it/s]
Loss: 1.3091 | Acc: 0.6919



==> Generating..
Generated_norm: 0.7373702526092529
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.20it/s]
Loss: 1.3464 | Acc: 0.6834



==> Generating..
Generated_norm: 0.7370849847793579
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.18it/s]
Loss: 1.2880 | Acc: 0.6945





(arpgen) wangkai@5a21df081e09:~/arpgen/AR-Param-Generation/workspace/evaluate$ CUDA_VISIBLE_DEVICES=5 python generate.py
==> Preparing data..
checkpoint number: 50
input shape: torch.Size([1510, 8192])
useful ratio: tensor(0.9458)
sequence length: 1510
==> Building model..
==> Building optimizer..
==> Defining training..
==> Building model..
==> Defining generate..
Save to ./dataset/imagenet_resnet18/generated/generated_imagenet_resnet18_large_001.pth

==> Generating..
Generated_norm: 0.8279823064804077
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.40it/s]
Loss: 1.2926 | Acc: 0.6952


Save to ./dataset/imagenet_resnet18/generated/generated_imagenet_resnet18_large_002.pth

==> Generating..
Generated_norm: 0.8280566930770874
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.07it/s]
Loss: 1.2916 | Acc: 0.6944


Save to ./dataset/imagenet_resnet18/generated/generated_imagenet_resnet18_large_003.pth

==> Generating..
Generated_norm: 0.8280614018440247
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.07it/s]
Loss: 1.2786 | Acc: 0.6968


Save to ./dataset/imagenet_resnet18/generated/generated_imagenet_resnet18_large_004.pth

==> Generating..
Generated_norm: 0.827954113483429
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.98it/s]
Loss: 1.3050 | Acc: 0.6904


Save to ./dataset/imagenet_resnet18/generated/generated_imagenet_resnet18_large_005.pth

==> Generating..
Generated_norm: 0.8280001878738403
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.97it/s]
Loss: 1.3147 | Acc: 0.6890


Save to ./dataset/imagenet_resnet18/generated/generated_imagenet_resnet18_large_006.pth

==> Generating..
Generated_norm: 0.8280487060546875
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.94it/s]
Loss: 1.2810 | Acc: 0.6962


Save to ./dataset/imagenet_resnet18/generated/generated_imagenet_resnet18_large_007.pth

==> Generating..
Generated_norm: 0.8280013203620911
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.83it/s]
Loss: 1.3350 | Acc: 0.6841


Save to ./dataset/imagenet_resnet18/generated/generated_imagenet_resnet18_large_008.pth

==> Generating..
Generated_norm: 0.8280106782913208
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.03it/s]
Loss: 1.3152 | Acc: 0.6892


Save to ./dataset/imagenet_resnet18/generated/generated_imagenet_resnet18_large_009.pth

==> Generating..
Generated_norm: 0.8280635476112366
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.40it/s]
Loss: 1.2907 | Acc: 0.6944


Save to ./dataset/imagenet_resnet18/generated/generated_imagenet_resnet18_large_010.pth

==> Generating..
Generated_norm: 0.8279752731323242
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.42it/s]
Loss: 1.2866 | Acc: 0.6954