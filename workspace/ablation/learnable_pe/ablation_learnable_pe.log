(arpgen) wangkai@5a21df081e09:~/arpgen/AR-Param-Generation/workspace/ablation/learnable_pe$ sh ablation_learnable_pe.sh
==> Preparing data..
checkpoint number: 51
input shape: torch.Size([808, 8192])
useful ratio: tensor(0.8638)
sequence length: 808
==> Building model..
==> Building optimizer..
==> Defining training..
==> start training..

==> Generating..
Generated_norm: 175.6713409423828
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.69it/s]
Loss: 100456.7881 | Acc: 0.0010



==> Generating..
Generated_norm: 0.7605902552604675
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.80it/s]
Loss: 8.8803 | Acc: 0.0013



==> Generating..
Generated_norm: 0.768379271030426
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.24it/s]
Loss: 4.1317 | Acc: 0.2256



==> Generating..
Generated_norm: 0.7696027159690857
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.93it/s]
Loss: 2.6865 | Acc: 0.4196



==> Generating..
Generated_norm: 0.7720601558685303
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.80it/s]
Loss: 2.0772 | Acc: 0.5245



==> Generating..
Generated_norm: 0.7686761021614075
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.66it/s]
Loss: 1.6602 | Acc: 0.5958



==> Generating..
Generated_norm: 0.7673286199569702
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.62it/s]
Loss: 1.8538 | Acc: 0.5655



==> Generating..
Generated_norm: 0.778134286403656
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.85it/s]
Loss: 1.5882 | Acc: 0.6100



==> Generating..
Generated_norm: 0.7659928798675537
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.32it/s]
Loss: 1.4731 | Acc: 0.6383



==> Generating..
Generated_norm: 0.7755764722824097
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.21it/s]
Loss: 1.3427 | Acc: 0.6634



==> Generating..
Generated_norm: 0.7750399112701416
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.11it/s]
Loss: 1.2730 | Acc: 0.6783



==> Generating..
Generated_norm: 0.7758856415748596
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.88it/s]
Loss: 1.3962 | Acc: 0.6541



==> Generating..
Generated_norm: 0.7688488960266113
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.58it/s]
Loss: 1.4072 | Acc: 0.6511



==> Generating..
Generated_norm: 0.7770130038261414
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.89it/s]
Loss: 1.4249 | Acc: 0.6491



==> Generating..
Generated_norm: 0.7679195404052734
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.42it/s]
Loss: 1.2303 | Acc: 0.6875



==> Generating..
Generated_norm: 0.776782214641571
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.83it/s]
Loss: 1.1614 | Acc: 0.7036



==> Generating..
Generated_norm: 0.7730350494384766
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.41it/s]
Loss: 1.2094 | Acc: 0.6928



==> Generating..
Generated_norm: 0.7736501693725586
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.29it/s]
Loss: 1.1479 | Acc: 0.7064



==> Generating..
Generated_norm: 0.7724938988685608
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.91it/s]
Loss: 1.1139 | Acc: 0.7134



==> Generating..
Generated_norm: 0.7753695249557495
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.89it/s]
Loss: 1.1017 | Acc: 0.7169



==> Generating..
Generated_norm: 0.776297390460968
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.28it/s]
Loss: 1.0895 | Acc: 0.7185



==> Generating..
Generated_norm: 0.767623782157898
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.64it/s]
Loss: 1.0845 | Acc: 0.7198



==> Generating..
Generated_norm: 0.7675421237945557
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.95it/s]
Loss: 1.0973 | Acc: 0.7187



==> Generating..
Generated_norm: 0.7703678607940674
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.36it/s]
Loss: 1.1410 | Acc: 0.7097



==> Generating..
Generated_norm: 0.7688537836074829
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:22<00:00, 10.94it/s]
Loss: 1.0859 | Acc: 0.7183



==> Generating..
Generated_norm: 0.7694467306137085
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.31it/s]
Loss: 1.0363 | Acc: 0.7302



==> Generating..
Generated_norm: 0.7699018120765686
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.23it/s]
Loss: 1.0379 | Acc: 0.7313



==> Generating..
Generated_norm: 0.7690930366516113
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.30it/s]
Loss: 1.0431 | Acc: 0.7285



==> Generating..
Generated_norm: 0.7705575227737427
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.93it/s]
Loss: 50.2689 | Acc: 0.2189



==> Generating..
Generated_norm: 0.770452082157135
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.17it/s]
Loss: 1.0322 | Acc: 0.7306



==> Generating..
Generated_norm: 0.7690395712852478
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.44it/s]
Loss: 0.9996 | Acc: 0.7394



==> Generating..
Generated_norm: 0.7775626182556152
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.29it/s]
Loss: 0.9985 | Acc: 0.7395



==> Generating..
Generated_norm: 0.7762159705162048
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.36it/s]
Loss: 0.9823 | Acc: 0.7433



==> Generating..
Generated_norm: 0.7718745470046997
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.82it/s]
Loss: 0.9775 | Acc: 0.7447



==> Generating..
Generated_norm: 0.7622926235198975
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.31it/s]
Loss: 0.9875 | Acc: 0.7438



==> Generating..
Generated_norm: 0.7741963267326355
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.66it/s]
Loss: 0.9679 | Acc: 0.7474



==> Generating..
Generated_norm: 0.7675652503967285
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.44it/s]
Loss: 0.9740 | Acc: 0.7464



==> Generating..
Generated_norm: 0.7708695530891418
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.67it/s]
Loss: 0.9549 | Acc: 0.7493



==> Generating..
Generated_norm: 0.7762024998664856
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.33it/s]
Loss: 0.9585 | Acc: 0.7486



==> Generating..
Generated_norm: 0.7642006278038025
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.78it/s]
Loss: 0.9610 | Acc: 0.7489



==> Generating..
Generated_norm: 0.7626737952232361
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.42it/s]
Loss: 0.9640 | Acc: 0.7475



==> Generating..
Generated_norm: 0.7676371335983276
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:22<00:00, 11.07it/s]
Loss: 0.9519 | Acc: 0.7501



==> Generating..
Generated_norm: 0.7707163691520691
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.67it/s]
Loss: 0.9491 | Acc: 0.7508



==> Generating..
Generated_norm: 0.7702881693840027
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.85it/s]
Loss: 0.9489 | Acc: 0.7522



==> Generating..
Generated_norm: 0.764923095703125
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.51it/s]
Loss: 0.9522 | Acc: 0.7498



==> Generating..
Generated_norm: 0.7745566964149475
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:22<00:00, 10.99it/s]
Loss: 0.9505 | Acc: 0.7502



==> Generating..
Generated_norm: 0.7674720287322998
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.02it/s]
Loss: 0.9448 | Acc: 0.7523



==> Generating..
Generated_norm: 0.7681609988212585
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:22<00:00, 10.95it/s]
Loss: 0.9442 | Acc: 0.7537



==> Generating..
Generated_norm: 0.7757798433303833
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.66it/s]
Loss: 0.9482 | Acc: 0.7520



==> Generating..
Generated_norm: 0.7681130170822144
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:22<00:00, 11.17it/s]
Loss: 0.9511 | Acc: 0.7507



==> Generating..
Generated_norm: 0.7661142945289612
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.42it/s]
Loss: 0.9451 | Acc: 0.7517





(arpgen) wangkai@5a21df081e09:~/arpgen/AR-Param-Generation/workspace/evaluate$ CUDA_VISIBLE_DEVICES=4 python generate.py
==> Preparing data..
checkpoint number: 51
input shape: torch.Size([808, 8192])
useful ratio: tensor(0.8638)
sequence length: 808
==> Building model..
==> Building optimizer..
==> Defining training..
==> Building model..
==> Defining generate..
Save to ./dataset/imagenet_vittiny/generated/generated_ablation_learnable_pe_001.pth

==> Generating..
Generated_norm: 1.3023896217346191
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.14it/s]
Loss: 0.9550 | Acc: 0.7493


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_learnable_pe_002.pth

==> Generating..
Generated_norm: 1.30035400390625
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:23<00:00, 10.57it/s]
Loss: 0.9475 | Acc: 0.7523


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_learnable_pe_003.pth

==> Generating..
Generated_norm: 1.2976773977279663
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.35it/s]
Loss: 0.9469 | Acc: 0.7519


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_learnable_pe_004.pth

==> Generating..
Generated_norm: 1.2894582748413086
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.09it/s]
Loss: 0.9501 | Acc: 0.7500


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_learnable_pe_005.pth

==> Generating..
Generated_norm: 1.2983688116073608
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.10it/s]
Loss: 0.9478 | Acc: 0.7517


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_learnable_pe_006.pth

==> Generating..
Generated_norm: 1.2938268184661865
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:28<00:00,  8.87it/s]
Loss: 0.9458 | Acc: 0.7518


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_learnable_pe_007.pth

==> Generating..
Generated_norm: 1.296251654624939
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.46it/s]
Loss: 0.9417 | Acc: 0.7511


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_learnable_pe_008.pth

==> Generating..
Generated_norm: 1.3014867305755615
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.31it/s]
Loss: 0.9479 | Acc: 0.7524


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_learnable_pe_009.pth

==> Generating..
Generated_norm: 1.298873782157898
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.60it/s]
Loss: 0.9497 | Acc: 0.7504


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_learnable_pe_010.pth

==> Generating..
Generated_norm: 1.2873135805130005
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.36it/s]
Loss: 0.9521 | Acc: 0.7502
