(arpgen) wangkai@5a21df081e09:~/arpgen/AR-Param-Generation/workspace/ablation/token_dim$ sh ablation_token_dim_2048.sh
==> Preparing data..
checkpoint number: 51
input shape: torch.Size([2878, 2048])
useful ratio: tensor(0.9700)
sequence length: 2878
==> Building model..
==> Building optimizer..
==> Defining training..
==> Building model..

==> Generating..
Generated_norm: 0.7563191056251526
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.84it/s]
Loss: 7.0750 | Acc: 0.0010



==> Generating..
Generated_norm: 0.7667503356933594
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.77it/s]
Loss: 8.7097 | Acc: 0.0024



==> Generating..
Generated_norm: 0.7666236758232117
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:24<00:00, 10.19it/s]
Loss: 8.8764 | Acc: 0.0032



==> Generating..
Generated_norm: 0.7669435739517212
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.65it/s]
Loss: 7.6633 | Acc: 0.0112



==> Generating..
Generated_norm: 0.7684320211410522
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:28<00:00,  8.70it/s]
Loss: 2.3609 | Acc: 0.4948



==> Generating..
Generated_norm: 0.7758833765983582
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.43it/s]
Loss: 5.1602 | Acc: 0.1367



==> Generating..
Generated_norm: 0.7737662196159363
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.77it/s]
Loss: 6.3726 | Acc: 0.0586



==> Generating..
Generated_norm: 0.775525689125061
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.48it/s]
Loss: 2.9490 | Acc: 0.3881



==> Generating..
Generated_norm: 0.7717211842536926
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.57it/s]
Loss: 4.9387 | Acc: 0.1604



==> Generating..
Generated_norm: 0.7771002054214478
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.02it/s]
Loss: 2.8574 | Acc: 0.3959



==> Generating..
Generated_norm: 0.7693615555763245
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.19it/s]
Loss: 37.3575 | Acc: 0.2533



==> Generating..
Generated_norm: 0.7793270349502563
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.46it/s]
Loss: 1.8248 | Acc: 0.5649



==> Generating..
Generated_norm: 0.7684850692749023
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.28it/s]
Loss: 1.5117 | Acc: 0.6277



==> Generating..
Generated_norm: 0.7736400365829468
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.14it/s]
Loss: 1.6315 | Acc: 0.6038



==> Generating..
Generated_norm: 0.7730290293693542
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.10it/s]
Loss: 1.9919 | Acc: 0.5352



==> Generating..
Generated_norm: 0.7660180926322937
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.50it/s]
Loss: 1.5110 | Acc: 0.6282



==> Generating..
Generated_norm: 0.7658495306968689
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.20it/s]
Loss: 1.8909 | Acc: 0.5528



==> Generating..
Generated_norm: 0.7690474390983582
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.25it/s]
Loss: 1.2885 | Acc: 0.6734



==> Generating..
Generated_norm: 0.7770234942436218
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.49it/s]
Loss: 1.9560 | Acc: 0.5431



==> Generating..
Generated_norm: 0.780360996723175
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.19it/s]
Loss: 1.5151 | Acc: 0.6255



==> Generating..
Generated_norm: 0.7820826172828674
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.25it/s]
Loss: 1.3025 | Acc: 0.6725



==> Generating..
Generated_norm: 0.7674288749694824
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.97it/s]
Loss: 1.3155 | Acc: 0.6673



==> Generating..
Generated_norm: 0.7726874947547913
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.70it/s]
Loss: 1.2933 | Acc: 0.6754



==> Generating..
Generated_norm: 0.7749749422073364
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.16it/s]
Loss: 1.1738 | Acc: 0.6991



==> Generating..
Generated_norm: 0.7782981991767883
100%|__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.09it/s]
Loss: 1.3832 | Acc: 0.6543



==> Generating..
Generated_norm: 0.7657434940338135
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.54it/s]
Loss: 1.2218 | Acc: 0.6893



==> Generating..
Generated_norm: 0.7722395062446594
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.13it/s]
Loss: 1.2681 | Acc: 0.6801



==> Generating..
Generated_norm: 0.7693742513656616
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  8.94it/s]
Loss: 1.1571 | Acc: 0.7046



==> Generating..
Generated_norm: 0.7675372958183289
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  8.98it/s]
Loss: 1.1791 | Acc: 0.6996



==> Generating..
Generated_norm: 0.7750468254089355
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.50it/s]
Loss: 1.1395 | Acc: 0.7073



==> Generating..
Generated_norm: 0.7735114693641663
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.29it/s]
Loss: 1.1163 | Acc: 0.7145



==> Generating..
Generated_norm: 0.7725023031234741
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:28<00:00,  8.73it/s]
Loss: 1.1969 | Acc: 0.6973



==> Generating..
Generated_norm: 0.7640129923820496
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:28<00:00,  8.66it/s]
Loss: 1.1218 | Acc: 0.7126



==> Generating..
Generated_norm: 0.7732126116752625
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.43it/s]
Loss: 1.1116 | Acc: 0.7141



==> Generating..
Generated_norm: 0.768687903881073
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.24it/s]
Loss: 1.0843 | Acc: 0.7213



==> Generating..
Generated_norm: 0.7695156335830688
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:29<00:00,  8.53it/s]
Loss: 1.0639 | Acc: 0.7241



==> Generating..
Generated_norm: 0.7766463160514832
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.37it/s]
Loss: 1.0862 | Acc: 0.7201



==> Generating..
Generated_norm: 0.7651986479759216
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:29<00:00,  8.55it/s]
Loss: 1.0751 | Acc: 0.7218



==> Generating..
Generated_norm: 0.7623765468597412
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.26it/s]
Loss: 1.0716 | Acc: 0.7228



==> Generating..
Generated_norm: 0.7670457363128662
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  8.99it/s]
Loss: 1.0576 | Acc: 0.7257



==> Generating..
Generated_norm: 0.7693668007850647
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.39it/s]
Loss: 1.0619 | Acc: 0.7256



==> Generating..
Generated_norm: 0.7701797485351562
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.34it/s]
Loss: 1.0683 | Acc: 0.7244



==> Generating..
Generated_norm: 0.7657710313796997
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:29<00:00,  8.51it/s]
Loss: 7.4933 | Acc: 0.0028



==> Generating..
Generated_norm: 0.7745077610015869
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  8.99it/s]
Loss: 1.0374 | Acc: 0.7313



==> Generating..
Generated_norm: 0.7668542265892029
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:25<00:00,  9.96it/s]
Loss: 1.0606 | Acc: 0.7258



==> Generating..
Generated_norm: 0.767919659614563
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.38it/s]
Loss: 1.0350 | Acc: 0.7307



==> Generating..
Generated_norm: 0.7746732831001282
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.50it/s]
Loss: 1.0274 | Acc: 0.7313



==> Generating..
Generated_norm: 0.7689902186393738
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.36it/s]
Loss: 1.0387 | Acc: 0.7308



==> Generating..
Generated_norm: 0.7662968635559082
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.49it/s]
Loss: 1.0413 | Acc: 0.7288





(arpgen) wangkai@5a21df081e09:~/arpgen/AR-Param-Generation/workspace/evaluate$ CUDA_VISIBLE_DEVICES=5 python generate.py
==> Preparing data..
checkpoint number: 51
input shape: torch.Size([2878, 2048])
useful ratio: tensor(0.9700)
sequence length: 2878
==> Building model..
==> Building optimizer..
==> Defining training..
==> Building model..
==> Defining generate..
Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_2048_001.pth

==> Generating..
Generated_norm: 0.7743425369262695
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:26<00:00,  9.34it/s]
Loss: 1.0828 | Acc: 0.7213


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_2048_002.pth

==> Generating..
Generated_norm: 0.7625638246536255
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:28<00:00,  8.84it/s]
Loss: 1.0955 | Acc: 0.7172


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_2048_003.pth

==> Generating..
Generated_norm: 0.7636566758155823
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.09it/s]
Loss: 1.1035 | Acc: 0.7159


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_2048_004.pth

==> Generating..
Generated_norm: 0.773357093334198
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.15it/s]
Loss: 1.0928 | Acc: 0.7188


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_2048_005.pth

==> Generating..
Generated_norm: 0.7733933925628662
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:28<00:00,  8.85it/s]
Loss: 1.0856 | Acc: 0.7200


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_2048_006.pth

==> Generating..
Generated_norm: 0.7681806087493896
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.22it/s]
Loss: 1.0873 | Acc: 0.7200


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_2048_007.pth

==> Generating..
Generated_norm: 0.7719862461090088
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:28<00:00,  8.85it/s]
Loss: 1.0884 | Acc: 0.7200


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_2048_008.pth

==> Generating..
Generated_norm: 0.7601555585861206
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:28<00:00,  8.76it/s]
Loss: 1.0996 | Acc: 0.7159


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_2048_009.pth

==> Generating..
Generated_norm: 0.7653805017471313
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:27<00:00,  9.18it/s]
Loss: 1.0812 | Acc: 0.7222


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_2048_010.pth

==> Generating..
Generated_norm: 0.7580960988998413
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:28<00:00,  8.79it/s]
Loss: 1.1175 | Acc: 0.7129