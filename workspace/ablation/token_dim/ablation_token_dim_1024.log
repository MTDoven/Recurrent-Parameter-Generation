(arpgen) wangkai@72d3bcb7a221:~/arpgen/AR-Param-Generation/workspace/ablation/token_dim$ sh ablation_token_dim_1024.sh
==> Preparing data..
checkpoint number: 50
input shape: torch.Size([5654, 1024])
useful ratio: tensor(0.9875)
sequence length: 5654
==> Building model..
==> Building optimizer..
==> Defining training..
==> start training..

==> Generating..
Generated_norm: 179.17601013183594
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.23it/s]
Loss: 122667.1887 | Acc: 0.0010



==> Generating..
Generated_norm: 0.7859872579574585
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.34it/s]
Loss: 8.9233 | Acc: 0.0014



==> Generating..
Generated_norm: 0.7724362015724182
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.63it/s]
Loss: 8.7676 | Acc: 0.0015



==> Generating..
Generated_norm: 0.7753592729568481
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:20<00:00, 12.49it/s]
Loss: 9.0185 | Acc: 0.0011



==> Generating..
Generated_norm: 0.7715141177177429
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:20<00:00, 12.28it/s]
Loss: 7.3796 | Acc: 0.0009



==> Generating..
Generated_norm: 0.7673885226249695
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.56it/s]
Loss: 8.7890 | Acc: 0.0010



==> Generating..
Generated_norm: 0.7698819041252136
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.29it/s]
Loss: 8.8277 | Acc: 0.0012



==> Generating..
Generated_norm: 0.7728192210197449
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.02it/s]
Loss: 9.2138 | Acc: 0.0010



==> Generating..
Generated_norm: 0.7753151655197144
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:21<00:00, 11.76it/s]
Loss: 8.9103 | Acc: 0.0010



==> Generating..
Generated_norm: 0.7721901535987854
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.04it/s]
Loss: 8.8324 | Acc: 0.0012



==> Generating..
Generated_norm: 0.7744337916374207
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.66it/s]
Loss: 8.7089 | Acc: 0.0015



==> Generating..
Generated_norm: 0.77698814868927
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.13it/s]
Loss: 9.3241 | Acc: 0.0012



==> Generating..
Generated_norm: 0.7726731896400452
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.20it/s]
Loss: 8.9601 | Acc: 0.0016



==> Generating..
Generated_norm: 0.7736538052558899
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.35it/s]
Loss: 8.8456 | Acc: 0.0016



==> Generating..
Generated_norm: 0.7731073498725891
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.05it/s]
Loss: 9.1630 | Acc: 0.0028



==> Generating..
Generated_norm: 0.768781304359436
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.13it/s]
Loss: 9.1346 | Acc: 0.0020



==> Generating..
Generated_norm: 0.7689720988273621
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.96it/s]
Loss: 8.8571 | Acc: 0.0030



==> Generating..
Generated_norm: 0.7719153165817261
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.99it/s]
Loss: 9.2783 | Acc: 0.0020



==> Generating..
Generated_norm: 0.7724587321281433
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.24it/s]
Loss: 8.7447 | Acc: 0.0022



==> Generating..
Generated_norm: 0.7718850374221802
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.15it/s]
Loss: 9.1729 | Acc: 0.0029



==> Generating..
Generated_norm: 0.7701850533485413
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.20it/s]
Loss: 8.4667 | Acc: 0.0027



==> Generating..
Generated_norm: 0.7721743583679199
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.93it/s]
Loss: 8.9781 | Acc: 0.0030



==> Generating..
Generated_norm: 0.7719952464103699
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.84it/s]
Loss: 8.9760 | Acc: 0.0028



==> Generating..
Generated_norm: 0.7726970314979553
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.02it/s]
Loss: 8.0752 | Acc: 0.0056



==> Generating..
Generated_norm: 0.7760100960731506
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.72it/s]
Loss: 8.8613 | Acc: 0.0052



==> Generating..
Generated_norm: 0.7752602100372314
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.32it/s]
Loss: 8.5954 | Acc: 0.0064



==> Generating..
Generated_norm: 0.7727296948432922
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.13it/s]
Loss: 8.6977 | Acc: 0.0064



==> Generating..
Generated_norm: 0.772659182548523
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.34it/s]
Loss: 8.9542 | Acc: 0.0035



==> Generating..
Generated_norm: 0.7730980515480042
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.78it/s]
Loss: 8.4199 | Acc: 0.0061



==> Generating..
Generated_norm: 0.76985102891922
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.83it/s]
Loss: 8.1913 | Acc: 0.0091



==> Generating..
Generated_norm: 0.7740420699119568
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:20<00:00, 12.26it/s]
Loss: 8.1600 | Acc: 0.0089



==> Generating..
Generated_norm: 0.7725221514701843
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.08it/s]
Loss: 8.1720 | Acc: 0.0145



==> Generating..
Generated_norm: 0.7722238302230835
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.05it/s]
Loss: 8.2144 | Acc: 0.0102



==> Generating..
Generated_norm: 0.7743221521377563
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.13it/s]
Loss: 7.9521 | Acc: 0.0121



==> Generating..
Generated_norm: 0.771692156791687
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.75it/s]
Loss: 7.9440 | Acc: 0.0122



==> Generating..
Generated_norm: 0.7744746804237366
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.80it/s]
Loss: 8.3025 | Acc: 0.0121



==> Generating..
Generated_norm: 0.7736213207244873
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.11it/s]
Loss: 7.6682 | Acc: 0.0171



==> Generating..
Generated_norm: 0.7703360915184021
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.09it/s]
Loss: 7.2518 | Acc: 0.0244



==> Generating..
Generated_norm: 0.7711746692657471
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.05it/s]
Loss: 7.8206 | Acc: 0.0195



==> Generating..
Generated_norm: 0.7708275318145752
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.04it/s]
Loss: 7.4878 | Acc: 0.0256



==> Generating..
Generated_norm: 0.7766278386116028
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.95it/s]
Loss: 8.3407 | Acc: 0.0103



==> Generating..
Generated_norm: 0.7733607292175293
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.74it/s]
Loss: 7.1495 | Acc: 0.0266



==> Generating..
Generated_norm: 0.7728607654571533
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.21it/s]
Loss: 8.4376 | Acc: 0.0145



==> Generating..
Generated_norm: 0.7734174132347107
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.81it/s]
Loss: 7.0325 | Acc: 0.0243



==> Generating..
Generated_norm: 0.773577094078064
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.19it/s]
Loss: 8.1053 | Acc: 0.0140



==> Generating..
Generated_norm: 0.7725902795791626
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.17it/s]
Loss: 8.2269 | Acc: 0.0123



==> Generating..
Generated_norm: 0.7736876010894775
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.90it/s]
Loss: 6.8695 | Acc: 0.0322



==> Generating..
Generated_norm: 0.7729750871658325
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.00it/s]
Loss: 6.8566 | Acc: 0.0316



==> Generating..
Generated_norm: 0.7720642685890198
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.04it/s]
Loss: 7.4308 | Acc: 0.0245



==> Generating..
Generated_norm: 0.7729477882385254
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.97it/s]
Loss: 6.5910 | Acc: 0.0356



==> Generating..
Generated_norm: 0.7734174132347107
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.88it/s]
Loss: 7.8569 | Acc: 0.0143





CUDA_VISIIB(arpgen) wangkai@72d3bcb7a221:~/arpgen/AR-Param-Generation/workspace/evaluate$ CUDA_VISIBLE_DEVICES=7 python generate.py
==> Preparing data..
checkpoint number: 50
input shape: torch.Size([5654, 1024])
useful ratio: tensor(0.9875)
sequence length: 5654
==> Building model..
==> Building optimizer..
==> Defining training..
==> Building model..
==> Defining generate..
Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_1024_001.pth

==> Generating..
Generated_norm: 0.776115357875824
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.28it/s]
Loss: 7.3411 | Acc: 0.0233


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_1024_002.pth

==> Generating..
Generated_norm: 0.7764617800712585
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.07it/s]
Loss: 7.3565 | Acc: 0.0290


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_1024_003.pth

==> Generating..
Generated_norm: 0.7757673263549805
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.07it/s]
Loss: 6.4380 | Acc: 0.0479


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_1024_004.pth

==> Generating..
Generated_norm: 0.7760118842124939
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.69it/s]
Loss: 8.0532 | Acc: 0.0177


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_1024_005.pth

==> Generating..
Generated_norm: 0.7762101888656616
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.49it/s]
Loss: 6.7148 | Acc: 0.0437


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_1024_006.pth

==> Generating..
Generated_norm: 0.7756490111351013
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.99it/s]
Loss: 7.6792 | Acc: 0.0164


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_1024_007.pth

==> Generating..
Generated_norm: 0.7763534784317017
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 13.16it/s]
Loss: 6.9824 | Acc: 0.0299


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_1024_008.pth

==> Generating..
Generated_norm: 0.7763285040855408
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:19<00:00, 12.87it/s]
Loss: 7.0083 | Acc: 0.0366


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_1024_009.pth

==> Generating..
Generated_norm: 0.7762259244918823
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:18<00:00, 13.38it/s]
Loss: 6.9275 | Acc: 0.0268


Save to ./dataset/imagenet_vittiny/generated/generated_ablation_token_dim_1024_010.pth

==> Generating..
Generated_norm: 0.7758193016052246
100%|___________________________________________________________________________________________________________________________________________________________________________________________________________________| 250/250 [00:21<00:00, 11.69it/s]
Loss: 7.5830 | Acc: 0.0236
